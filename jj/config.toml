[aliases]
bootstrap = ["git", "init", "--colocate"]
fresh = ["new", "main"]
gf = ["git", "fetch"]
gp = ["git", "push"]
pushdown = ["rebase", "-r", "@-", "--insert-after"]
tug = ["bookmark", "move", "--from", "tuggable()", "--to", "tug_target()"]
up = ["rebase", "-d", "main"]

commitid = ["log", "--no-graph", "--template", "commit_id"]

all = ["log", "-r", "all()"]
l = ["log", "-r", "main..@"]
ll = ["log", "-r", "::@ & ~remote_bookmarks()"]
llb = ["log", "-r", "bookmarks() & ~(main | remote_bookmarks())"]
lrb = ["log", "-r", "@ | ancestors(remote_bookmarks().., 2) | trunk()"]
lt = ["log", "-r", "tags()"]

[merge-tools.diffconflicts]
program = "nvim"
merge-args = ["-c", "JJDiffConflicts!", "$output", "$base", "$left", "$right"]
merge-tool-edits-conflict-markers = true

[revset-aliases]
"tug_target()" = "@- & ~private()"
"tuggable()" = "heads(::@- & bookmarks() & ~private())"
"private()" = "description(glob:\"private:*\")"
"lagging_bookmarks()" = '''
  ::bookmarks()
  & mutable()
  & mine()
  ~ trunk()::
  '''

[templates]
draft_commit_description = "commit_description_with_diff"

[template-aliases]
commit_description_with_diff = '''
concat(
  description,
  surround(
    "\nJJ: This commit contains the following changes:\n", "",
    indent("JJ:     ", diff.stat(72)),
  ),
  surround(
    "\nJJ: Diff:\n", "",
    indent("JJ:     ", diff.git(72)),
  ),
)
'''

[ui]
default-command = "log"

[user]
name = "Luke Randall"
email = "luke.randall@gmail.com"

[git]
private-commits = "private()"
